$(document).ready(function(){function addDots(Value){Value+="";for(var rgx=/(\d+)(\d\d\d)/;rgx.test(Value);)Value=Value.replace(rgx,"$1.$2");return Value}function removeNonDigit(Value){return Value=(Value+="").replace(/[^0-9]/g,"")}function Calculate(UsingMain){void 0===UsingMain&&(UsingMain=!1);var ResM=removeNonDigit($('[name="'+NameResM+'"]').val()),ResA=removeNonDigit($('[name="'+NameResA+'"]').val()),ResB=removeNonDigit($('[name="'+NameResB+'"]').val()),Needed;!1===UsingMain?(1==Mode?Needed=Math.ceil(ResA*Mod_ResA+ResB*Mod_ResB):2==Mode&&(Needed=Math.floor(ResA*Mod_ResA+ResB*Mod_ResB)),$("#MainRes").val(addDots(Needed))):1==Mode?(ResA=Math.floor(ResM*(parseInt($('[name="'+NameResA+'Percent"]').val())/100)/Mod_ResA),ResB=Math.floor(ResM*(parseInt($('[name="'+NameResB+'Percent"]').val())/100)/Mod_ResB),$('[name="'+NameResA+'"]').val(ResA).prettyInputBox(!0),$('[name="'+NameResB+'"]').val(ResB).prettyInputBox(!0)):2==Mode&&(ResA=Math.floor(ResM*(parseInt($('[name="'+NameResA+'Percent"]').val())/100)/Mod_ResA),ResB=Math.floor(ResM*(parseInt($('[name="'+NameResB+'Percent"]').val())/100)/Mod_ResB),$('[name="'+NameResA+'"]').val(ResA).prettyInputBox(!0),$('[name="'+NameResB+'"]').val(ResB).prettyInputBox(!0));1==Mode?ResM>MaxResM?$('[name="'+NameResM+'"]').addClass("resRed"):$('[name="'+NameResM+'"]').hasClass("resRed")&&$('[name="'+NameResM+'"]').removeClass("resRed"):(ResA>MaxResA?$('[name="'+NameResA+'"]').addClass("resRed"):$('[name="'+NameResA+'"]').hasClass("resRed")&&$('[name="'+NameResA+'"]').removeClass("resRed"),ResB>MaxResB?$('[name="'+NameResB+'"]').addClass("resRed"):$('[name="'+NameResB+'"]').hasClass("resRed")&&$('[name="'+NameResB+'"]').removeClass("resRed"))}$.fn.notEmptyVal=function(canBeZero,doRemoveNonDigit){var ThisVal=$(this).val();return doRemoveNonDigit&&(ThisVal=removeNonDigit(ThisVal)),canBeZero?""!=ThisVal&&ThisVal>=0:""!=ThisVal&&ThisVal>0},$.fn.prettyInputBox=function(IgnoreUserSetting){return this.each(function(){if(void 0!==AllowPrettyInputBox&&!0===AllowPrettyInputBox||void 0!==IgnoreUserSetting&&!0===IgnoreUserSetting){var Value=$(this).val();-1!==Value.indexOf(".")&&(Value=Value.replace(/\./g,"")),Value=addDots(Value),$(this).val(Value)}})},$('[name="met"],[name="cry"],[name="deu"]').change(function(){$(this).val(removeNonDigit($(this).val())),$(this).attr("name")!=NameResM?Calculate():Calculate(!0),$(this).prettyInputBox(!0)}).keyup(function(){$(this).change()}).keydown(function(event){var ThisCount;if(38==event.which)ThisCount=parseFloat(removeNonDigit($(this).val())),isNaN(ThisCount)&&(ThisCount=0),$(this).val(ThisCount+1).change();else if(40==event.which){if(ThisCount=parseFloat(removeNonDigit($(this).val())),isNaN(ThisCount)||ThisCount<=0)return!1;$(this).val(ThisCount-1).change()}}).focus(function(){$(this).notEmptyVal(!1,!0)||$(this).val("")}).blur(function(){$(this).notEmptyVal(!0,!0)||$(this).val("0")}),$("#max"+NameResM).click(function(){return 1==Mode?$('[name="'+NameResM+'"]').val(Math.floor(MaxResM)).change():2==Mode&&($('[name="'+NameResA+'"]').val(Math.floor(MaxResA)).change(),$('[name="'+NameResB+'"]').val(Math.floor(MaxResB)).change()),!1}),$("#max"+NameResA).click(function(){return 1==Mode?($('[name="'+NameResA+'"]').val(Math.floor(MaxResM/Mod_ResA)).change(),$("#zero"+NameResB).click(),$('[name="'+NameResA+'Percent"]').val(100).change()):2==Mode&&$('[name="'+NameResA+'"]').val(Math.floor(MaxResA)).change(),!1}),$("#max"+NameResB).click(function(){return 1==Mode?($('[name="'+NameResB+'"]').val(Math.floor(MaxResM/Mod_ResB)).change(),$("#zero"+NameResA).click(),$('[name="'+NameResB+'Percent"]').val(100).change()):2==Mode&&$('[name="'+NameResB+'"]').val(Math.floor(MaxResB)).change(),!1}),$("#zero"+NameResM).click(function(){return $('[name="'+NameResM+'"]').val("0").change(),!1}),$("#zero"+NameResA).click(function(){return $('[name="'+NameResA+'"]').val("0").change(),!1}),$("#zero"+NameResB).click(function(){return $('[name="'+NameResB+'"]').val("0").change(),!1}),$(".modif").click(function(){var ThisElement=$('[name="'+$(this).parent().children("input.percent").attr("name")+'"]'),AddValue;AddValue="+"==$(this).val()?1:-1,ThisElement.val(parseInt(ThisElement.val())+AddValue),ThisElement.change()}),$("input.percent").change(function(){var OpositeSelector;if(OpositeSelector=$(this).attr("name")==NameResA+"Percent"?$('[name="'+NameResB+'Percent"]'):$('[name="'+NameResA+'Percent"]'),$.isNumeric($(this).val())){var ThisVal=parseInt($(this).val());ThisVal>100?ThisVal=100:ThisVal<0&&(ThisVal=0),$(this).val(ThisVal),OpositeSelector.val(100-ThisVal)}else $(this).val(0),OpositeSelector.val(100);Calculate(!0)}).keyup(function(){return $(this).change(),!1}).keypress(function(event){if(13==event.which)return!1}).keydown(function(event){var ThisCount;if(38==event.which){if(ThisCount=parseFloat(removeNonDigit($(this).val())),isNaN(ThisCount))ThisCount=0;else if(ThisCount>=100)return!1;$(this).val(ThisCount+1).change()}else if(40==event.which){if(ThisCount=parseFloat(removeNonDigit($(this).val())),isNaN(ThisCount)||ThisCount<=0)return!1;$(this).val(ThisCount-1).change()}}),$("th").css("padding","3px")});